<?php
    session_start();
    include 'db.php';

    $id = $_POST['id'];
    $pw = $_POST['password'];

    if(!$id) {
        echo "
        <script>
            alert('아이디를 입력하세요!');
            history.back();
        </script>";
    } elseif (!$pw) {
        echo "
        <script>
            alert('패스워드를 입력하세요!');
            history.back();
        </script>";
    } else {
        // $sql = "SELECT * FROM test WHERE id = '$id' AND password = '$pw'";
        $sql = "SELECT * FROM users \n WHERE id = '$id'";
        // $member = $sql->fetch_array();
        // $member = mysqli_query($db, $sql);
        $result = $db->query($sql);
        $member = $result->fetch_array();

        if($member['password'] == md5($pw)) {
            $_SESSION['id'] = $member['id'];
            $_SESSION['password'] = $member['password'];
            $_SESSION['nickname'] = $member['nickname'];

            echo "
            <script>
                alert('로그인되었습니다.'); location.href='../main.php';
            </script>
            ";
        } else {
            echo "
            <script>
                alert('아이디 혹은 비밀번호를 확인하세요.'); history.back();
            </script>
            ";
        }

        // if($member) {
        //     $_SESSION['id'] = $member['id'];
        //     // $_SESSION['password'] = $member['password'];
        //     // $_SESSION['nickname'] = $member['nickname'];

        //     echo "
        //     <script>
        //         alert('로그인되었습니다.'); location.href='../welcome.php';
        //     </script>
        //     ";
        // } else {
        //     echo "
        //     <script>
        //         alert('아이디 혹은 비밀번호를 확인하세요.'); history.back();
        //     </script>
        //     ";
        // }
    }
?>